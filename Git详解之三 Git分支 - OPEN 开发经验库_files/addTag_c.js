/*! 1768 2013-9-17 14:8:14 */
define(["lib/jquery/1_9","kit/cross_msg","pjt/content_ex/transport/all","pjt/content_ex/view/addTag_v"],function(e,t,n,i){var r=function(r){var o={},a={},s=function(){o.viewAddTag=o.buildView(),a.bindData(r)};return o.buildView=function(){return i(a)},a.render=function(){return o.viewAddTag.dom},a.hide=function(){e(o.viewAddTag.dom).hide()},a.bindData=function(){o.viewAddTag.bindData(r),a.getUserTags()},a.saveTag=function(t){var i,o,s={records:[]};for(i=0,o=r.aKey.length;o>i;++i)s.records.push({_key:r.aKey[i]._key,tags:t.sTagList.split(",")});n.saveTags({data:{param:JSON.stringify(s),bdstoken:r.bdstoken},ok:function(t){e(a).trigger("saveTagsOk",t)}})},a.getUserTags=function(){n.getUserTags({data:{bdstoken:r.bdstoken},ok:function(e){a.bindTags({aTagList:e.data.records})}})},a.close=function(){t.postMessage(parent,{cmd:"CLOSE_IFRAME"})},a.bindTags=function(e){o.viewAddTag.bindTags(e)},s(),a};return r});